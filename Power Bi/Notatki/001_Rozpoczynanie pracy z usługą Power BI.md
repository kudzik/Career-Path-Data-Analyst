# Rozpoczynanie pracy z usługą Power BI

## Wprowadzenie do analizy danych

- **Rola danych w biznesie**: Dane są strategicznym aktywem firm, a ich analiza i wykorzystanie mają kluczowe znaczenie dla wprowadzania pozytywnych zmian w działalności firmy.

- **Wykorzystanie danych w handlu detalicznym**: Firmy detaliczne wykorzystują dane do śledzenia zapasów, identyfikowania nawyków zakupowych, wykrywania trendów, rekomendowania zakupów, optymalizacji cen oraz identyfikacji i zatrzymywania oszustw.

- **Opowiadanie historii z danymi**: Kluczowe jest umiejętne opowiadanie historii za pomocą danych, aby ułatwić liderom biznesowym podejmowanie decyzji na podstawie danych i zwiększyć konkurencyjność firmy.

- **Współpraca z ekspertami**: Pierwszym krokiem w analizie danych jest współpraca z ekspertami ds. danych, takimi jak inżynierowie danych i analitycy danych, aby uzyskać potrzebne dane i opowiedzieć historię, która wspiera kulturę danych w organizacji

Analiza danych to proces przekształcania surowych danych w wartościowe informacje i wnioski, które mogą być wykorzystane do podejmowania lepszych decyzji. Jest to kluczowy element w wielu dziedzinach, takich jak biznes, nauka, medycyna czy marketing.

## Analiza danych

**Etapy analizy danych:**

1. **Zdefiniowanie problemu:** Określenie celu analizy, pytań, na które chcemy odpowiedzieć, oraz wskaźników, które chcemy mierzyć.
2. **Gromadzenie danych:** Zebranie danych z różnych źródeł, takich jak bazy danych, pliki, arkusze kalkulacyjne, API czy IoT.
3. **Oczyszczanie danych:** Usunięcie błędów, duplikatów, brakujących wartości oraz przekształcenie danych do odpowiedniego formatu.
4. **Eksploracja danych:** Analiza statystyczna i wizualizacja danych w celu odkrycia wzorców, trendów, zależności i anomalii.
5. **Modelowanie danych:** Budowanie modeli predykcyjnych lub klasyfikacyjnych, które pozwalają przewidywać przyszłe wyniki lub klasyfikować dane do określonych kategorii.
6. **Interpretacja wyników:** Wyciąganie wniosków z analizy, formułowanie rekomendacji i podejmowanie decyzji na podstawie uzyskanych informacji.
7. **Prezentacja wyników:** Komunikowanie wyników analizy w sposób jasny i zrozumiały dla odbiorców, np. za pomocą raportów, prezentacji czy dashboardów.

**Rodzaje analizy danych:**

- **Analiza opisowa:** Odpowiada na pytanie "co się stało?" poprzez podsumowanie i opisanie danych historycznych.
- **Analiza diagnostyczna:** Odpowiada na pytanie "dlaczego tak się stało?" poprzez identyfikację przyczyn zdarzeń i zależności między zmiennymi.
- **Analiza predykcyjna:** Odpowiada na pytanie "co się prawdopodobnie stanie?" poprzez budowanie modeli, które przewidują przyszłe wyniki na podstawie danych historycznych.
- **Analiza preskrypcyjna:** Odpowiada na pytanie "co powinniśmy zrobić?" poprzez sugerowanie działań, które mogą poprawić wyniki lub rozwiązać problemy.

**Narzędzia do analizy danych:**

- **Arkusze kalkulacyjne:** Proste narzędzia do podstawowej analizy i wizualizacji danych (np. Microsoft Excel, Google Sheets).
- **Języki programowania:** Elastyczne narzędzia do bardziej zaawansowanej analizy danych (np. Python, R, SQL).
- **Platformy BI:** Narzędzia do raportowania, wizualizacji i analizy danych biznesowych (np. Power BI, Tableau, Qlik Sense).
- **Narzędzia specjalistyczne:** Narzędzia do konkretnych zadań, takich jak analiza tekstu, analiza sieci społecznościowych czy analiza szeregów czasowych.

## Rodzaje analizy danych

Istnieje kilka rodzajów analizy danych, z których każdy ma inny cel i wykorzystuje różne metody:

**1. Analiza opisowa (Descriptive Analysis):**

- **Cel:** Podsumowanie i opisanie tego, co wydarzyło się w przeszłości.
- **Pytania:** Co się stało? Jakie są trendy?
- **Metody:**
  - Miary statystyczne (średnia, mediana, odchylenie standardowe)
  - Wizualizacje danych (wykresy, tabele, dashboardy)
  - Analiza kohort
  - Analiza skupień (clustering)
- **Przykład:** Raport sprzedaży podsumowujący wyniki za ostatni kwartał, z wykresami przedstawiającymi sprzedaż według produktów, regionów i kanałów sprzedaży.

**2. Analiza diagnostyczna (Diagnostic Analysis):**

- **Cel:** Zrozumienie, dlaczego coś się wydarzyło.
- **Pytania:** Dlaczego tak się stało? Jakie są przyczyny?
- **Metody:**
  - Analiza przyczyn źródłowych (root cause analysis)
  - Drążenie w głąb danych (drill-down)
  - Analiza korelacji
  - Analiza regresji
- **Przykład:** Analiza spadku sprzedaży w określonym regionie, z uwzględnieniem czynników takich jak konkurencja, zmiany cen, promocje.

**3. Analiza predykcyjna (Predictive Analysis):**

- **Cel:** Przewidywanie, co może się wydarzyć w przyszłości.
- **Pytania:** Co się stanie? Jakie są prawdopodobne wyniki?
- **Metody:**
  - Modele regresji
  - Drzewa decyzyjne
  - Sieci neuronowe
  - Uczenie maszynowe
- **Przykład:** Prognozowanie sprzedaży na kolejny kwartał na podstawie danych historycznych, trendów rynkowych i czynników zewnętrznych.

**4. Analiza normatywna (Prescriptive Analysis):**

- **Cel:** Zalecenie działań, które należy podjąć, aby osiągnąć pożądany wynik.
- **Pytania:** Co powinniśmy zrobić? Jakie są najlepsze opcje?
- **Metody:**
  - Optymalizacja
  - Symulacje
  - Modele decyzyjne
- **Przykład:** Określenie optymalnej ceny produktu, która zmaksymalizuje zysk, przy uwzględnieniu kosztów produkcji, popytu i konkurencji.

**5. Analiza poznawcza (Cognitive Analysis):**

- **Cel:** Wykorzystanie sztucznej inteligencji (AI) i przetwarzania języka naturalnego (NLP) do analizy danych nieustrukturyzowanych, takich jak tekst, obrazy czy dźwięk.
- **Pytania:** Co mówią nam te dane? Jakie są ukryte wzorce?
- **Metody:**
  - Analiza sentymentu
  - Rozpoznawanie obrazów
  - Analiza tekstu
  - Uczenie maszynowe
- **Przykład:** Analiza opinii klientów w mediach społecznościowych, aby zrozumieć ich nastawienie do marki i produktów.

## Role związane z analizą danych

**Analityk biznesowy (Business Analyst):**

- **Główne zadanie:** Łączy świat biznesu z technologią. Rozumie potrzeby biznesowe i przekłada je na wymagania dotyczące danych i analiz.
- **Umiejętności:**
  - Znajomość branży i procesów biznesowych
  - Umiejętność komunikacji z interesariuszami na różnych poziomach
  - Umiejętność analizy danych i wyciągania wniosków
  - Znajomość narzędzi do analizy danych (np. Excel, Power BI)
- **Przykładowe zadania:**
  - Zbieranie wymagań biznesowych od interesariuszy
  - Tworzenie analiz biznesowych i raportów
  - Identyfikacja możliwości poprawy procesów biznesowych

**Analityk danych (Data Analyst):**

- **Główne zadanie:** Analizuje dane, aby odkryć trendy, wzorce i zależności, które mogą pomóc w podejmowaniu lepszych decyzji biznesowych.
- **Umiejętności:**
  - Znajomość statystyki i metod analizy danych
  - Umiejętność programowania w językach takich jak Python, R lub SQL
  - Znajomość narzędzi do wizualizacji danych (np. Power BI, Tableau)
- **Przykładowe zadania:**
  - Czyszczenie i przygotowywanie danych do analizy
  - Tworzenie modeli statystycznych i predykcyjnych
  - Wizualizacja danych i tworzenie raportów

**Inżynier danych (Data Engineer):**

- **Główne zadanie:** Projektuje, buduje i utrzymuje infrastrukturę danych, która umożliwia przechowywanie, przetwarzanie i analizę dużych ilości danych.
- **Umiejętności:**
  - Znajomość baz danych (np. SQL Server, Oracle, PostgreSQL)
  - Znajomość technologii przetwarzania danych (np. Hadoop, Spark)
  - Umiejętność programowania w językach takich jak Python, Java lub Scala
- **Przykładowe zadania:**
  - Projektowanie i implementacja hurtowni danych
  - Tworzenie potoków danych (data pipelines)
  - Optymalizacja wydajności zapytań

**Mistrz danych (Data Master):**

- **Główne zadanie:** Odpowiada za jakość i spójność danych w organizacji. Zapewnia, że dane są dokładne, kompletne i zgodne z obowiązującymi standardami.
- **Umiejętności:**
  - Znajomość zarządzania danymi (data governance)
  - Znajomość modelowania danych
  - Umiejętność komunikacji z różnymi działami w organizacji
- **Przykładowe zadania:**
  - Definiowanie standardów jakości danych
  - Monitorowanie jakości danych i identyfikacja problemów
  - Wdrażanie procesów zarządzania danymi

**Administrator bazy danych (Database Administrator):**

- **Główne zadanie:** Zarządza bazami danych, zapewniając ich dostępność, wydajność i bezpieczeństwo.
- **Umiejętności:**
  - Znajomość systemów zarządzania bazami danych (np. SQL Server, Oracle, MySQL)
  - Znajomość języka SQL
  - Umiejętność rozwiązywania problemów technicznych
- **Przykładowe zadania:**
  - Instalacja, konfiguracja i aktualizacja baz danych
  - Monitorowanie wydajności baz danych
  - Tworzenie kopii zapasowych i odzyskiwanie danych

## Czym jest Power BI

Power BI to narzędzie do analizy biznesowej (Business Intelligence) stworzone przez Microsoft. Umożliwia ono przekształcanie danych z różnych źródeł w interaktywne raporty, pulpity nawigacyjne i wizualizacje, które pomagają w podejmowaniu lepszych decyzji biznesowych.

**Główne składniki Power BI:**

- **Power BI Desktop:** Bezpłatna aplikacja desktopowa do tworzenia raportów i wizualizacji. Umożliwia łączenie się z danymi, ich przekształcanie, modelowanie oraz tworzenie interaktywnych raportów.
- **Power BI Service (w chmurze):** Platforma online do publikowania, udostępniania i zarządzania raportami. Umożliwia współpracę zespołową, dostęp do raportów z różnych urządzeń oraz tworzenie pulpitów nawigacyjnych.
- **Aplikacje mobilne Power BI:** Dostęp do raportów i pulpitów nawigacyjnych na urządzeniach mobilnych (iOS, Android).

**Do czego służy Power BI?**

- **Łączenie danych:** Power BI pozwala łączyć się z wieloma różnymi źródłami danych, takimi jak pliki Excel, bazy danych SQL, usługi w chmurze (np. SharePoint, Salesforce), a nawet dane z mediów społecznościowych.
- **Przekształcanie i modelowanie danych:** Możesz czyścić dane, usuwać błędy, łączyć tabele, tworzyć relacje, obliczenia i miary.
- **Wizualizacja danych:** Twórz różnorodne wykresy, tabele, mapy, wykresy słupkowe, liniowe, kołowe, a nawet niestandardowe wizualizacje.
- **Interaktywne raporty:** Raporty Power BI są interaktywne, co oznacza, że możesz filtrować, sortować i przeglądać dane na różne sposoby.
- **Pulpity nawigacyjne:** Pulpity nawigacyjne to zbiór wizualizacji, które dostarczają szybkiego przeglądu najważniejszych wskaźników.
- **Udostępnianie i współpraca:** Możesz łatwo udostępniać raporty i pulpity nawigacyjne innym osobom w organizacji, zarówno online, jak i poprzez publikowanie ich w aplikacji Power BI.

**Korzyści z używania Power BI:**

- **Lepsze zrozumienie danych:** Wizualizacje pomagają dostrzec trendy, wzorce i zależności, których nie widać w surowych danych.
- **Szybsze podejmowanie decyzji:** Dostęp do aktualnych informacji umożliwia podejmowanie decyzji w oparciu o dane.
- **Poprawa wydajności:** Automatyzacja raportowania i analiz pozwala zaoszczędzić czas i zasoby.
- **Dostępność:** Raporty i pulpity nawigacyjne są dostępne z dowolnego miejsca i urządzenia.

## Elementy Power BI

**Pojemności (Capacities):**

- Zasoby obliczeniowe w chmurze przeznaczone dla Power BI.
- Dzielą się na współdzielone (dla wszystkich użytkowników) i dedykowane (dla konkretnych rozwiązań).
- Wpływają na wydajność, odświeżanie danych, skalowalność.
- Wybór pojemności zależy od potrzeb organizacji (np. ilość danych, użytkowników, częstotliwość odświeżania).

**Obszary robocze (Workspaces):**

- Miejsca do przechowywania, zarządzania i udostępniania raportów, pulpitów nawigacyjnych i zestawów danych.
- Można je tworzyć dla różnych projektów, zespołów lub działów.
- Ułatwiają organizację pracy i kontrolę dostępu do zasobów.

1. **Mój obszar roboczy (My Workspace):**

Jest to Twoja osobista przestrzeń w Power BI, przeznaczona do pracy z własnymi danymi i analizami. Tylko Ty masz dostęp do tego obszaru, co zapewnia prywatność i bezpieczeństwo Twoich projektów. Możesz tutaj tworzyć raporty, pulpity nawigacyjne i zestawy danych, a następnie udostępniać je innym użytkownikom.

2. **Obszary robocze (Workspaces):**

To przestrzenie współpracy, w których możesz dzielić się swoimi projektami z innymi użytkownikami Power BI i wspólnie nad nimi pracować. Możesz dodawać współpracowników do obszarów roboczych i wspólnie tworzyć, edytować i udostępniać raporty, pulpity nawigacyjne i zestawy danych. Wszyscy członkowie obszaru roboczego (z jednym wyjątkiem) muszą posiadać licencję Power BI Pro, aby móc w pełni korzystać z jego funkcji.

**Podsumowanie:**

| Funkcja       | Mój obszar roboczy                                      | Obszary robocze                                              |
| ------------- | ------------------------------------------------------- | ------------------------------------------------------------ |
| Dostęp        | Tylko Ty                                                | Współpracownicy z licencją Power BI Pro (z wyjątkiem*)       |
| Przeznaczenie | Praca indywidualna, tworzenie i udostępnianie projektów | Współpraca nad projektami, wspólne tworzenie i udostępnianie |

*Wyjątek: użytkownicy bez licencji Power BI Pro mogą mieć dostęp do obszaru roboczego, jeśli jest on umieszczony w pojemności Premium.

**Modele semantyczne (Semantic Models):**

- Struktura danych, która definiuje relacje między tabelami, kolumnami i miarami.
- Umożliwia tworzenie obliczeń, miar i hierarchii.
- Ułatwia analizę danych i tworzenie raportów.
- DAX (Data Analysis Expressions) to język używany do definiowania obliczeń w modelu.

**Raporty (Reports):**

- Interaktywne wizualizacje danych w postaci wykresów, tabel, map itp.
- Umożliwiają eksplorację danych, identyfikację trendów i wzorców.
- Można je filtrować, sortować i przeglądać na różne sposoby.

**Pulpity nawigacyjne (Dashboards):**

- Zbiór wizualizacji z jednego lub wielu raportów.
- Dostarczają szybkiego przeglądu najważniejszych wskaźników.
- Można je dostosować do potrzeb użytkownika.

**Aplikacje szablonów (Template Apps):**

- Gotowe rozwiązania Power BI do analizy określonych danych (np. dane sprzedażowe, marketingowe, finansowe).
- Ułatwiają szybkie wdrożenie Power BI w organizacji.
- Można je dostosować do własnych potrzeb.

**Podsumowanie:**

| Element             | Opis                                                                             |
| ------------------- | -------------------------------------------------------------------------------- |
| Pojemności          | Zasoby obliczeniowe w chmurze wpływające na wydajność i skalowalność Power BI.   |
| Obszary robocze     | Miejsca do przechowywania, zarządzania i udostępniania zasobów Power BI.         |
| Modele semantyczne  | Struktura danych definiująca relacje, obliczenia i miary.                        |
| Raporty             | Interaktywne wizualizacje danych umożliwiające eksplorację i analizę.            |
| Pulpity nawigacyjne | Zbiór wizualizacji dostarczający szybkiego przeglądu najważniejszych wskaźników. |
| Aplikacje szablonów | Gotowe rozwiązania Power BI do analizy określonych danych.                       |

## Czyszczenie i przekształcanie danych

**Czyszczenie i Przekształcanie Danych**
Praca z danymi z różnych źródeł może wymagać ich dostosowania do wspólnego formatu. Na przykład, przygotowując raport użycia urządzenia IoT dla klientów, dane z systemu CRM i systemu IoT mogą się różnić. Power BI Desktop umożliwia czyszczenie i przekształcanie danych, przygotowując je do analizy i raportowania.

**Widoki w Power BI Desktop**
Power BI Desktop oferuje trzy widoki pracy z danymi:

- **Widok Raportu**: Tworzenie wizualizacji i zapytań.
- **Widok Danych**: Przeglądanie i edycja danych w modelu.
- **Widok Modelu**: Zarządzanie relacjami w modelu danych.

Czyszczenie i przekształcanie danych w Power BI Desktop to kluczowy etap przygotowania danych do analizy. Dzięki temu procesowi możesz zapewnić, że Twoje dane są dokładne, spójne i gotowe do tworzenia wartościowych raportów i wizualizacji.

**Power Query Editor:**

Sercem czyszczenia i przekształcania danych w Power BI Desktop jest Power Query Editor. To interaktywne środowisko, które umożliwia przeglądanie, modyfikowanie i przekształcanie danych z różnych źródeł, zanim zostaną one załadowane do modelu danych.

**Typowe zadania czyszczenia i przekształcania danych:**

- **Usuwanie wierszy i kolumn:** Możesz usuwać zbędne wiersze (np. duplikaty) i kolumny, które nie są potrzebne do analizy.
- **Zmiana typów danych:** Upewnij się, że kolumny mają odpowiednie typy danych (np. tekst, liczba, data), aby umożliwić poprawne obliczenia i wizualizacje.
- **Obsługa brakujących danych:** Wypełnij brakujące wartości (np. zerami, średnią) lub usuń wiersze z brakującymi danymi.
- **Usuwanie błędów i niespójności:** Popraw błędy ortograficzne, ujednolicaj formaty danych (np. daty, waluty) i usuwaj nieprawidłowe wartości.
- **Podział kolumn:** Podziel kolumny zawierające wiele informacji na osobne kolumny.
- **Scalanie kolumn:** Połącz informacje z kilku kolumn w jedną.
- **Scalanie i dołączanie tabel:** Połącz dane z różnych tabel, aby uzyskać pełniejszy obraz.
- **Grupowanie i agregacja:** Grupuj dane według określonych kryteriów i obliczaj statystyki podsumowujące (np. sumy, średnie).
- **Tworzenie kolumn obliczeniowych:** Twórz nowe kolumny na podstawie istniejących danych, używając formuł i wyrażeń.
- **Pivoting i unpivoting:** Zmień strukturę tabel, aby ułatwić analizę.
- **Sortowanie i filtrowanie:** Uporządkuj dane według określonych kryteriów i wybierz tylko te wiersze, które spełniają określone warunki.

**Zalety czyszczenia i przekształcania danych w Power BI Desktop:**

- **Poprawa jakości danych:** Zapewnienie dokładności i spójności danych.
- **Ułatwienie analizy:** Przygotowanie danych do tworzenia raportów i wizualizacji.
- **Oszczędność czasu:** Automatyzacja powtarzalnych zadań.
- **Elastyczność:** Możliwość dostosowania procesu do specyficznych potrzeb.

**Dodatkowe wskazówki:**

- **Używaj podglądu danych:** Regularnie sprawdzaj efekty swoich przekształceń, aby upewnić się, że wszystko działa zgodnie z oczekiwaniami.
- **Dokumentuj kroki:** Dodawaj opisy do kroków przekształcania, aby ułatwić zrozumienie procesu.

## Korzystanie z usługi Power BI

- **Power BI Desktop**: Aplikacja dla analityków danych do tworzenia raportów
- **Usługa Power BI**: Platforma online do organizowania, rozpowszechniania i zarządzania raportami
- **Power BI dla urządzeń przenośnych**: Aplikacja mobilna do wyświetlania raportów zoptymalizowanych dla urządzeń przenośnych

## Eksplorowanie przepływu usługi Power BI

- **Tworzenie Raportów**: Rozpoczynasz od Power BI Desktop, aby połączyć się z danymi i utworzyć raport.
- **Publikacja i Zarządzanie**: Następnie publikujesz raport w usłudze Power BI i rozpowszechniasz go użytkownikom

## Przepływ usługi Power BI

- Nawiązywanie połączenia z danymi przy użyciu Power BI Desktop.
- Przekształcanie i modelowanie danych za pomocą Power BI Desktop.
- Tworzenie wizualizacji i raportów przy użyciu Power BI Desktop.
- Publikowanie raportu w usługa Power BI.
- Rozpowszechniaj raporty w usługa Power BI i zarządzaj nimi.

Usługa Power BI umożliwia również tworzenie pulpitów nawigacyjnych wysokiego poziomu, które umożliwiają przechodzenie do szczegółów raportów i aplikacji w celu łatwego grupowania powiązanych raportów z użytkownikami w prostym formacie.

## Bloki konstrukcyjne usługi Power BI

Bloki konstrukcyjne usługi Power BI obejmują:

Rozpocznij od połączenia się ze wszystkimi niezbędnymi źródłami danych. Następnie przystąp do oczyszczenia i przekształcenia danych, dostosowując je do swoich wymagań. Uzupełnij model semantyczny, dodając relacje między tabelami oraz tworząc obliczenia. Po wykonaniu tych kroków jesteś gotowy do stworzenia raportu.

1. **Modele semantyczne:**
   - **Definicja:** Struktura danych, która definiuje relacje między tabelami, kolumnami i miarami.
   - **Rola:** Ułatwia analizę danych i tworzenie raportów poprzez:
      - Definiowanie relacji między tabelami, co pozwala na łączenie danych z różnych źródeł.
      - Tworzenie miar (obliczeń), które agregują dane i dostarczają dodatkowych informacji.
      - Definiowanie hierarchii, które umożliwiają analizę danych na różnych poziomach szczegółowości.
      - Używanie języka DAX (Data Analysis Expressions) do tworzenia zaawansowanych obliczeń i analiz.

2. **Wizualizacje:**
   - **Definicja:** Graficzne reprezentacje danych, takie jak wykresy, tabele, mapy itp.
   - **Rola:** Umożliwiają zrozumienie danych i wyciąganie wniosków poprzez:
      - Prezentowanie danych w sposób łatwy do zrozumienia.
      - Ujawnianie trendów, wzorców i zależności między danymi.
      - Umożliwianie interakcji z danymi, np. filtrowanie, sortowanie, przechodzenie do szczegółów.
      - Dostarczanie atrakcyjnej i angażującej formy prezentacji danych.

**Jak te bloki konstrukcyjne współpracują ze sobą:**

- Model semantyczny dostarcza strukturę danych, która jest wykorzystywana przez wizualizacje do prezentacji informacji.
- Wizualizacje pozwalają na interakcję z modelem semantycznym, np. poprzez filtrowanie danych lub przechodzenie do szczegółów.
- Razem umożliwiają one użytkownikom zrozumienie danych, wyciąganie wniosków i podejmowanie decyzji na podstawie analizy.

**Przykłady:**

- **Model semantyczny:** Zawiera tabele z danymi o sprzedaży (produkty, klienci, transakcje) oraz relacje między nimi.
- **Wizualizacje:** Wykres słupkowy pokazujący sprzedaż według kategorii produktów, tabela przestawna umożliwiająca analizę sprzedaży według klientów i regionów, mapa pokazująca rozkład sprzedaży geograficznie.

## Obszary robocze w Power BI

**Obszary robocze w Power BI - podstawowe informacje**

Obszary robocze w Power BI to kontenery, które pozwalają na grupowanie i zarządzanie powiązanymi raportami, pulpitami nawigacyjnymi, zestawami danych i przepływami danych. Są one podstawową jednostką organizacyjną w Power BI i służą do współpracy, udostępniania i zarządzania dostępem do zawartości.

**Rodzaje obszarów roboczych:**

- **Moje obszary robocze:** Prywatne obszary robocze, w których możesz tworzyć i przechowywać zawartość tylko dla siebie.
- **Obszary robocze w chmurze:** Obszary robocze współdzielone, w których możesz współpracować z innymi użytkownikami.
- **Obszary robocze Premium:** Obszary robocze dostępne tylko dla użytkowników z licencją Power BI Premium, oferujące dodatkowe funkcje i wydajność.

**Dlaczego warto korzystać z obszarów roboczych?**

- **Organizacja:** Grupowanie powiązanych elementów ułatwia ich wyszukiwanie i zarządzanie.
- **Współpraca:** Udostępnianie obszarów roboczych innym użytkownikom umożliwia wspólną pracę nad raportami i pulpitami nawigacyjnymi.
- **Zarządzanie dostępem:** Możesz kontrolować, kto ma dostęp do poszczególnych obszarów roboczych i jakie uprawnienia posiadają (np. przeglądanie, edycja, udostępnianie).
- **Publikowanie aplikacji:** Obszary robocze są podstawą do tworzenia i publikowania aplikacji Power BI, które są interaktywnymi kolekcjami raportów i pulpitów nawigacyjnych.

**Jak tworzyć i zarządzać obszarami roboczymi?**

1. **Tworzenie obszaru roboczego:** W Power BI Service kliknij "Utwórz" i wybierz "Obszar roboczy". Podaj nazwę i opis obszaru roboczego, a następnie wybierz typ obszaru roboczego (Moje obszary robocze, Obszar roboczy w chmurze lub Obszar roboczy Premium).

2. **Dodawanie zawartości:** W obszarze roboczym możesz tworzyć nowe raporty, pulpity nawigacyjne, zestawy danych i przepływy danych, a także importować istniejącą zawartość.

3. **Udostępnianie obszaru roboczego:** Aby udostępnić obszar roboczy innym użytkownikom, kliknij "Udostępnij" i dodaj ich adresy e-mail. Możesz wybrać, jakie uprawnienia chcesz im przyznać.

4. **Zarządzanie zawartością:** W obszarze roboczym możesz przeglądać, edytować, usuwać i przenosić elementy. Możesz również tworzyć foldery, aby lepiej organizować zawartość.

**Dobre praktyki:**

- Twórz obszary robocze dla konkretnych projektów lub zespołów.
- Używaj opisowych nazw obszarów roboczych.
- Udostępniaj obszary robocze tylko tym użytkownikom, którzy ich potrzebują.
- Regularnie przeglądaj i aktualizuj zawartość obszarów roboczych.

## Poznawanie Power BI Desktop

Przykladowy plik z danymi Excel [Link](<Source Data/Financial Sample.xlsx>)

### Instalacja Power BI Desktop

Instalacja Power BI Desktop może odbyć się na dwa sposoby:

**1. Instalacja z linku (bezpośrednio z witryny Microsoft):**

- **Krok 1:** Wejdź na stronę pobierania Power BI Desktop: [https://powerbi.microsoft.com/pl-pl/desktop/](https://powerbi.microsoft.com/pl-pl/desktop/)
- **Krok 2:** Kliknij przycisk "Pobierz bezpłatnie".
- **Krok 3:** Wybierz odpowiednią wersję (32-bit lub 64-bit) w zależności od systemu operacyjnego.
- **Krok 4:** Po zakończeniu pobierania uruchom plik instalacyjny (PBIDesktopSetup.exe).
- **Krok 5:** Postępuj zgodnie z instrukcjami kreatora instalacji.
- **Krok 6:** Po zakończeniu instalacji uruchom Power BI Desktop.

**Zalety:**

- Możliwość wyboru wersji 32-bit lub 64-bit.
- Większa kontrola nad procesem instalacji.

**Wady:**

- Wymaga ręcznego pobierania i uruchamiania pliku instalacyjnego.

**2. Instalacja ze sklepu Windows:**

- **Krok 1:** Otwórz Microsoft Store na swoim komputerze.
- **Krok 2:** Wyszukaj "Power BI Desktop".
- **Krok 3:** Kliknij przycisk "Pobierz" lub "Zainstaluj".
- **Krok 4:** Po zakończeniu instalacji uruchom Power BI Desktop.

**Zalety:**

- Prostszy i szybszy proces instalacji.
- Automatyczne aktualizacje.

**Wady:**

- Nie ma możliwości wyboru wersji 32-bit lub 64-bit.
- Mniejsza kontrola nad procesem instalacji.

**Którą metodę wybrać?**

### Omówienie interfejsu

**Główne elementy interfejsu:**

1. **Wstążka (Ribbon):** Znajduje się na górze okna i zawiera karty z różnymi funkcjami, takimi jak "Plik", "Narzędzia główne", "Wstaw", "Modelowanie", "Widok", "Optymalizowanie" i "Pomoc". Każda karta zawiera zestaw narzędzi i opcji związanych z daną funkcjonalnością.

2. **Okienko Wizualizacje:** Znajduje się po prawej stronie i zawiera listę dostępnych typów wizualizacji, które można dodać do raportu. Można je wybierać i przeciągać na obszar roboczy raportu.

3. **Okienko Dane:** Znajduje się również po prawej stronie i wyświetla listę tabel i pól dostępnych w załadowanym modelu danych. Pola te można przeciągać i upuszczać na wizualizacje, aby określić, jakie dane mają być wyświetlane.

4. **Obszar roboczy raportu (Kanwa):** To centralna część okna, gdzie tworzy się raport. Tutaj umieszczane są wizualizacje, można je dostosowywać, zmieniać ich rozmiar i położenie.

5. **Pasek Filtry:** Znajduje się na dole okna i umożliwia dodawanie filtrów do raportu, które pozwalają na ograniczenie wyświetlanych danych do określonych wartości lub zakresów.

**Aktywne elementy:**

- **"Utwórz element wizualny":** Jest to zachęta do rozpoczęcia tworzenia wizualizacji poprzez przeciągnięcie pól z okienka "Dane" na obszar roboczy raportu.
- **"Strona 1":** Wskazuje, że aktualnie pracujemy na pierwszej stronie raportu. Power BI umożliwia tworzenie raportów wielostronicowych.
- **"Filtry":** Sugeruje możliwość dodania filtrów do raportu.

## Połaczenie ze źródłem danych

Power BI Desktop umożliwia połączenie z wieloma różnymi źródłami danych, zarówno lokalnymi (np. bazy danych, pliki Excel), jak i usługami w chmurze. Istnieje ponad 60 dedykowanych łączników do popularnych usług, takich jak GitHub czy Marketo, a także możliwość połączenia z danymi ogólnymi poprzez pliki XML, CSV, tekst czy ODBC. Można nawet wyodrębnić dane tabelaryczne bezpośrednio z adresu URL strony internetowej.

Aby nawiązać połączenie, należy wybrać opcję "Pobierz dane" na wstążce w zakładce "Narzędzia główne". Następnie wybrać źródło danych z listy dostępnych opcji. W zależności od wybranego źródła, może być konieczne wskazanie lokalizacji pliku lub zalogowanie się do usługi w celu uwierzytelnienia.

Po nawiązaniu połączenia, pojawi się okno "Nawigator", w którym wyświetlone zostaną tabele lub jednostki źródła danych. Wybierając konkretną tabelę lub jednostkę, można zobaczyć podgląd jej zawartości. Dane można zaimportować bezpośrednio, wybierając "Załaduj", lub przekształcić je przed załadowaniem, wybierając "Przekształć dane".

Przed załadowaniem danych warto dokonać ewentualnych zmian, takich jak filtrowanie czy wybór tylko potrzebnych kolumn. Po wybraniu tabel do zaimportowania, należy kliknąć przycisk "Załaduj".

Przekształcanie danych w Power BI Desktop to kluczowy etap przygotowania ich do analizy i raportowania. Proces ten odbywa się w Edytorze Power Query, który oferuje wiele narzędzi do czyszczenia, formatowania i przekształcania danych.

**Uruchamianie Edytora Power Query:**

1. Po załadowaniu danych do Power BI Desktop, przejdź do zakładki "Narzędzia główne" na wstążce.
2. Kliknij przycisk "Przekształć dane".
3. Otworzy się Edytor Power Query, gdzie możesz rozpocząć pracę z danymi.

**Zmiana typów danych w kolumnie:**

1. W Edytorze Power Query zaznacz kolumnę, której typ danych chcesz zmienić.
2. Na karcie "Przekształcanie" kliknij przycisk "Typ danych" i wybierz odpowiedni typ z listy (np. tekst, liczba całkowita, data).
3. Power Query automatycznie przekształci dane w kolumnie do wybranego typu.

**Historia kroków:**

- Edytor Power Query rejestruje każdy krok przekształcania danych, tworząc listę kroków zastosowanych w zapytaniu.
- Możesz przeglądać historię kroków w okienku "Zastosowane kroki" po prawej stronie edytora.
- Historia kroków pozwala na cofnięcie lub zmianę dowolnego kroku, co ułatwia eksperymentowanie i dostosowywanie przekształceń.

**Przykład:**

Załóżmy, że importujesz dane sprzedażowe z pliku CSV. W Edytorze Power Query możesz:

1. Usunąć niepotrzebne kolumny.
2. Zmienić typ danych kolumny "Data sprzedaży" na format daty.
3. Utworzyć kolumnę obliczeniową "Miesiąc sprzedaży" na podstawie kolumny "Data sprzedaży".
4. Odfiltrować dane, aby uwzględnić tylko sprzedaż z określonego regionu.

Każdy z tych kroków zostanie zapisany w historii kroków, umożliwiając łatwe modyfikacje i dostosowanie przekształceń w przyszłości.

**Podsumowanie:**

Przekształcanie danych w Edytorze Power Query to potężne narzędzie, które pozwala dostosować dane do potrzeb analizy. Zmiana typów danych, tworzenie kolumn obliczeniowych i filtrowanie to tylko niektóre z dostępnych funkcji. Historia kroków zapewnia elastyczność i kontrolę nad procesem przekształcania.

## Scalanie i dołączanie zapytań

W Power BI, zarówno "Scal zapytania" jak i "Dołącz zapytania" służą do łączenia danych z różnych źródeł, ale robią to na różne sposoby:

**Scal zapytania (Merge Queries):**

- **Cel:** Połączenie dwóch tabel na podstawie wspólnej kolumny, tworząc nową tabelę zawierającą dane z obu źródeł.
- **Kiedy używać:** Gdy chcesz połączyć informacje z dwóch tabel, które mają wspólną kolumnę identyfikującą (np. ID klienta, ID produktu).
- **Rodzaje scalania:**
  - **Wewnętrzne:** Zachowuje tylko wiersze, które mają pasujące wartości we wspólnej kolumnie.
  - **Lewe zewnętrzne:** Zachowuje wszystkie wiersze z pierwszej tabeli i pasujące wiersze z drugiej tabeli.
  - **Prawe zewnętrzne:** Zachowuje wszystkie wiersze z drugiej tabeli i pasujące wiersze z pierwszej tabeli.
  - **Pełne zewnętrzne:** Zachowuje wszystkie wiersze z obu tabel, nawet jeśli nie ma pasujących wartości.

**Dołącz zapytania (Append Queries):**

- **Cel:** Połączenie dwóch lub więcej tabel o podobnej strukturze (takich samych kolumnach) w jedną tabelę.
- **Kiedy używać:** Gdy chcesz połączyć dane z różnych źródeł, które mają tę samą strukturę, np. dane sprzedażowe z różnych miesięcy.
- **Rodzaje dołączania:**
  - **Dołączanie wierszy:** Dodaje wiersze z jednej tabeli na końcu drugiej tabeli.
  - **Dołączanie kolumn:** Dodaje kolumny z jednej tabeli obok kolumn drugiej tabeli (rzadziej stosowane).

**Przykład:**

Załóżmy, że masz dwie tabele:

- **Tabela1:** Zawiera informacje o klientach (ID klienta, imię, nazwisko).
- **Tabela2:** Zawiera informacje o zamówieniach (ID zamówienia, ID klienta, data zamówienia).

Aby połączyć te tabele i uzyskać informacje o klientach i ich zamówieniach, możesz użyć opcji "Scal zapytania" na podstawie wspólnej kolumny "ID klienta".

Jeśli natomiast masz dwie tabele z danymi sprzedażowymi z różnych miesięcy (o tych samych kolumnach), możesz użyć opcji "Dołącz zapytania", aby połączyć je w jedną tabelę.

**Podsumowanie:**

| Funkcja      | Scal zapytania                                                   | Dołącz zapytania                             |
| ------------ | ---------------------------------------------------------------- | -------------------------------------------- |
| Cel          | Połączenie tabel na podstawie wspólnej kolumny.                  | Połączenie tabel o podobnej strukturze.      |
| Kiedy używać | Gdy tabele mają wspólną kolumnę identyfikującą.                  | Gdy tabele mają tę samą strukturę (kolumny). |
| Rodzaje      | Wewnętrzne, lewe zewnętrzne, prawe zewnętrzne, pełne zewnętrzne. | Dołączanie wierszy, dołączanie kolumn.       |

## Oczyszczanie danych

Oczyszczanie danych do uwzględnienia w raporcie to proces przygotowania danych, aby były one dokładne, spójne i gotowe do analizy. Jest to kluczowy etap przed tworzeniem raportów w Power BI, ponieważ jakość danych bezpośrednio wpływa na wiarygodność i przydatność analiz.

**Typowe problemy z danymi:**

- **Brakujące wartości:** Dane mogą zawierać puste komórki lub pola, które nie zostały wypełnione.
- **Duplikaty:** Mogą występować powtarzające się rekordy, które należy usunąć.
- **Błędy typograficzne i niespójności:** Dane mogą zawierać literówki, nieprawidłowe formaty dat lub inne niespójności.
- **Nieprawidłowe wartości:** Niektóre wartości mogą być nierealistyczne lub niezgodne z oczekiwaniami (np. ujemne wartości sprzedaży).
- **Zbyt duża ilość danych:** Duże zbiory danych mogą utrudniać analizę i spowalniać działanie raportów.

**Kroki oczyszczania danych w Power BI:**

1. **Import danych:** Załaduj dane do Power BI Desktop z różnych źródeł (pliki, bazy danych, usługi online).
2. **Otwórz Edytor Power Query:** Kliknij "Przekształć dane" na wstążce, aby otworzyć Edytor Power Query.
3. **Usuń niepotrzebne kolumny:** Jeśli masz kolumny, które nie są potrzebne do analizy, usuń je.
4. **Usuń niepotrzebne wiersze:** Usuń duplikaty, puste wiersze lub wiersze z nieprawidłowymi wartościami.
5. **Wypełnij brakujące wartości:** Uzupełnij brakujące dane zerami, średnią, medianą lub inną wartością.
6. **Popraw błędy i niespójności:** Popraw literówki, ujednolicaj formaty dat i wartości liczbowych.
7. **Przekształć dane:** Zmień strukturę danych, np. podziel kolumnę na wiele kolumn lub połącz wiele kolumn w jedną.
8. **Utwórz kolumny obliczeniowe:** Dodaj nowe kolumny z wartościami obliczonymi na podstawie istniejących danych.
9. **Zmień typy danych:** Upewnij się, że kolumny mają odpowiednie typy danych (np. tekst, liczba, data).
10. **Zamknij i zastosuj:** Po zakończeniu oczyszczania danych zamknij Edytor Power Query i zastosuj zmiany.

**Dodatkowe wskazówki:**

- **Profilowanie danych:** Przed rozpoczęciem oczyszczania przeanalizuj dane, aby zrozumieć ich strukturę i jakość.
- **Dokumentowanie kroków:** Zapisuj każdy krok oczyszczania, aby móc go później odtworzyć lub zmodyfikować.
- **Testowanie:** Po oczyszczeniu danych przetestuj raporty, aby upewnić się, że działają poprawnie.

Oczyszczanie danych to iteracyjny proces, który może wymagać wielu powtórzeń. Im dokładniej oczyścisz dane, tym bardziej wiarygodne i przydatne będą Twoje raporty.

## Wprowadzenie do modelowania danych

Modelowanie danych to proces organizowania, strukturyzowania i definiowania relacji między danymi w celu stworzenia logicznego i wydajnego modelu, który będzie służył jako podstawa do analizy i raportowania. W Power BI, modelowanie danych jest kluczowym krokiem w przekształcaniu surowych danych w wartościowe informacje.

**Dlaczego modelowanie danych jest ważne?**

- **Usprawnienie analizy:** Dobrze zaprojektowany model danych ułatwia użytkownikom zrozumienie danych i tworzenie raportów.
- **Poprawa wydajności:** Optymalizacja modelu danych może przyspieszyć wykonywanie zapytań i raportów.
- **Zapewnienie spójności:** Model danych definiuje jednolite reguły i definicje, co zapewnia spójność danych w całej organizacji.
- **Ułatwienie rozbudowy:** Dobrze zaprojektowany model danych jest łatwiejszy do rozbudowy i dostosowywania do zmieniających się potrzeb biznesowych.

**Kluczowe elementy modelowania danych w Power BI:**

1. **Tabele:** Podstawowe jednostki przechowywania danych, podobne do arkuszy kalkulacyjnych. Każda tabela reprezentuje określony rodzaj informacji (np. klienci, produkty, zamówienia).

2. **Kolumny:** Przechowują poszczególne wartości danych w tabeli (np. imię klienta, cena produktu, data zamówienia).

3. **Relacje:** Definiują powiązania między tabelami na podstawie wspólnych kolumn. Umożliwiają łączenie danych z różnych tabel i tworzenie bardziej złożonych analiz.

4. **Miary (Measures):** Obliczenia wykonywane na danych, takie jak sumy, średnie, wartości maksymalne i minimalne. Miary są dynamiczne i aktualizowane w czasie rzeczywistym wraz ze zmianami danych.

5. **Hierarchie:** Struktury logiczne, które grupują dane na różnych poziomach szczegółowości (np. rok, kwartał, miesiąc).

**Proces modelowania danych w Power BI:**

1. **Import danych:** Załaduj dane do Power BI Desktop z różnych źródeł (pliki, bazy danych, usługi online).
2. **Przekształcanie danych:** Oczyść i przekształć dane w Edytorze Power Query, aby przygotować je do analizy.
3. **Tworzenie modelu danych:** Utwórz relacje między tabelami, zdefiniuj miary i hierarchie.
4. **Optymalizacja modelu danych:** Usprawnij model danych, aby poprawić wydajność i łatwość użytkowania.
5. **Tworzenie raportów i wizualizacji:** Wykorzystaj model danych do tworzenia raportów i wizualizacji, które przedstawią dane w sposób zrozumiały i użyteczny.
6. **Miary** (Measures): Obliczenia wykonywane na danych, takie jak sumy, średnie, wartości maksymalne i minimalne. Miary są dynamiczne i aktualizowane w czasie rzeczywistym wraz ze zmianami danyc

**Narzędzia do modelowania danych w Power BI:**

- **Widok relacji:** Graficzna reprezentacja relacji między tabelami w modelu danych.
- **Widok danych:** Tabelaryczny widok danych, który umożliwia przeglądanie i edycję danych.
- **DAX (Data Analysis Expressions):** Język formuł używany do tworzenia miar i kolumn obliczeniowych.

**Podsumowanie:**

Modelowanie danych to kluczowy etap w procesie analizy danych w Power BI. Dobrze zaprojektowany model danych ułatwia analizę, poprawia wydajność, zapewnia spójność i ułatwia rozbudowę.

### Wprowadzenie do Relacji Tabel

#### 1.1 Czym są relacje tabel w Power BI?

Relacje tabel w Power BI to logiczne powiązania między różnymi tabelami w modelu danych, które umożliwiają łączenie i analizowanie danych z wielu źródeł. Relacje te są tworzone na podstawie kolumn, które zawierają wspólne wartości. W praktyce relacje tabel pozwalają na:

- Tworzenie bardziej zaawansowanych analiz poprzez łączenie danych z różnych tabel.
- Używanie danych z powiązanych tabel w raportach i wizualizacjach.
- Zachowanie integralności danych poprzez definiowanie logicznych powiązań między zestawami danych.

#### 1.2 Znaczenie relacji w modelu danych

Relacje są kluczowe w tworzeniu skutecznych i spójnych modeli danych w Power BI z kilku powodów:

- **Łączenie danych z różnych źródeł**: Pozwalają na integrację danych z wielu źródeł, co jest niezbędne w kompleksowych analizach biznesowych.
- **Tworzenie spójnych wizualizacji**: Dzięki relacjom możemy tworzyć wizualizacje, które przedstawiają dane z różnych tabel w sposób spójny i zrozumiały.
- **Optymalizacja zapytań**: Relacje pomagają w optymalizacji zapytań, co może znacząco poprawić wydajność raportów i analiz.
- **Zarządzanie danymi**: Ułatwiają zarządzanie i aktualizację danych, ponieważ zmiany w jednej tabeli automatycznie odzwierciedlają się w powiązanych tabelach.

#### Przykład praktyczny

Załóżmy, że mamy dwie tabele:

1. **Sprzedaż**: Zawiera dane o transakcjach sprzedaży (np. ID transakcji, data, ID produktu, ilość, wartość sprzedaży).
2. **Produkty**: Zawiera informacje o produktach (np. ID produktu, nazwa produktu, kategoria, cena jednostkowa).

Aby móc analizować, które produkty sprzedają się najlepiej, tworzymy relację między tabelą "Sprzedaż" a tabelą "Produkty" na podstawie kolumny "ID produktu". Dzięki tej relacji możemy tworzyć raporty i wizualizacje, które pokazują dane sprzedaży w kontekście informacji o produktach (np. łączna wartość sprzedaży dla każdej kategorii produktów).

To wprowadzenie stanowi fundament zrozumienia relacji tabel w Power BI. W kolejnych rozdziałach omówimy, jak tworzyć i zarządzać relacjami oraz jak rozwiązywać potencjalne problemy związane z ich używaniem.

## Tworzenie Relacji Tabel

### 2.1 Jak tworzyć relacje w Power BI?

Tworzenie relacji w Power BI jest kluczowe dla efektywnego modelowania danych. Możemy to zrobić automatycznie lub ręcznie. Poniżej znajdują się kroki dla obu metod, a także omówienie kluczy głównych i obcych oraz typów relacji.

#### 2.1.1 Tworzenie relacji automatycznych

Power BI może automatycznie wykrywać relacje między tabelami na podstawie zgodnych nazw kolumn i typów danych.

1. **Importuj dane do Power BI Desktop**.
2. **Przejdź do widoku "Model"**: Kliknij ikonę modelu (trzy połączone prostokąty) w lewym pasku narzędzi.
3. **Sprawdź automatyczne relacje**: Power BI automatycznie wykryje i utworzy relacje między tabelami, jeśli spełnione są warunki (zgodność nazw kolumn).

#### 2.1.2 Tworzenie relacji ręcznych

Jeżeli Power BI nie wykryje automatycznie relacji lub jeśli chcesz utworzyć niestandardowe relacje, możesz to zrobić ręcznie:

1. **Przejdź do widoku "Model"**.
2. **Kliknij i przeciągnij**: Kliknij kolumnę w jednej tabeli (np. "ID produktu" w tabeli "Sprzedaż") i przeciągnij ją na odpowiadającą kolumnę w drugiej tabeli (np. "ID produktu" w tabeli "Produkty").
3. **Karta relacji**: Pojawi się okno dialogowe, w którym możesz skonfigurować szczegóły relacji.
   - **Kolumny**: Upewnij się, że wybrane kolumny są prawidłowe.
   - **Typ relacji**: Wybierz typ relacji (jeden-do-wielu, wiele-do-jednego, wiele-do-wielu).
   - **Filtrowanie krzyżowe**: Określ kierunek filtrowania (jednokierunkowe lub dwukierunkowe).

#### 2.2 Ustalanie kluczy głównych i obcych

Klucze główne i obce są kluczowymi elementami w tworzeniu relacji między tabelami:

- **Klucz główny**: Unikalna kolumna w tabeli, która identyfikuje każde wiersz. Na przykład, w tabeli "Produkty", kolumna "ID produktu" może być kluczem głównym.
- **Klucz obcy**: Kolumna w innej tabeli, która odnosi się do klucza głównego. Na przykład, w tabeli "Sprzedaż", kolumna "ID produktu" będzie kluczem obcym odnoszącym się do "ID produktu" w tabeli "Produkty".

#### 2.3 Typy relacji

W Power BI możemy tworzyć różne typy relacji, które definiują, jak tabele są ze sobą powiązane:

##### 2.3.1 Relacje jeden-do-jednego (1:1)

W relacji jeden-do-jednego każda wartość w jednej tabeli odpowiada dokładnie jednej wartości w drugiej tabeli.

- **Przykład**: Tabela "Pracownicy" z unikalnym "ID pracownika" i tabela "Dane kontaktowe" z unikalnym "ID pracownika".

##### 2.3.2 Relacje jeden-do-wielu (1:N)

W relacji jeden-do-wielu jedna wartość w jednej tabeli może odpowiadać wielu wartościom w drugiej tabeli.

- **Przykład**: Tabela "Produkty" z unikalnym "ID produktu" i tabela "Sprzedaż" z wieloma wierszami dla "ID produktu".

##### 2.3.3 Relacje wiele-do-wielu (N:N)

Relacje wiele-do-wielu występują, gdy wartości w obu tabelach mogą mieć wiele odpowiadających im wartości.

- **Przykład**: Tabela "Studenci" i tabela "Kursy", gdzie jeden student może być zapisany na wiele kursów, a jeden kurs może mieć wielu studentów. Wymaga to dodatkowej tabeli pośredniej, takiej jak "Zapisy", która łączy "ID studenta" i "ID kursu".

### Przykład tworzenia relacji

1. **Przykład relacji jeden-do-wielu**:
   - Importuj tabele "Sprzedaż" i "Produkty".
   - Przejdź do widoku "Model".
   - Kliknij "ID produktu" w tabeli "Sprzedaż" i przeciągnij ją do "ID produktu" w tabeli "Produkty".
   - W oknie dialogowym upewnij się, że typ relacji to "jeden-do-wielu" i kliknij "OK".

2. **Przykład relacji wiele-do-wielu**:
   - Importuj tabele "Studenci", "Kursy" i "Zapisy".
   - Przejdź do widoku "Model".
   - Utwórz relację między "ID studenta" w tabeli "Studenci" i "ID studenta" w tabeli "Zapisy".
   - Utwórz relację między "ID kursu" w tabeli "Kursy" i "ID kursu" w tabeli "Zapisy".
   - W obu przypadkach upewnij się, że typ relacji to "wiele-do-wielu" i kliknij "OK".

### Rozdział 3: Zarządzanie Relacjami

#### 3.1 Edytowanie Istniejących Relacji

Power BI umożliwia modyfikowanie istniejących relacji oraz usuwanie ich, gdy nie są już potrzebne.

##### 3.1.1 Modyfikowanie relacji

Aby edytować relację:

1. **Przejdź do widoku "Model"**.
2. **Znajdź relację, którą chcesz edytować**: Relacje są widoczne jako linie łączące kolumny między tabelami.
3. **Kliknij dwukrotnie linię relacji**: Otworzy się okno dialogowe "Edycja relacji".
4. **Zmodyfikuj ustawienia relacji**: Możesz zmienić typ relacji, kolumny, które tworzą relację, oraz kierunek filtrowania (jednokierunkowe lub dwukierunkowe).
5. **Zatwierdź zmiany**: Kliknij "OK", aby zapisać zmiany.

##### 3.1.2 Usuwanie relacji

Aby usunąć relację:

1. **Przejdź do widoku "Model"**.
2. **Znajdź relację, którą chcesz usunąć**.
3. **Kliknij prawym przyciskiem myszy na linię relacji**.
4. **Wybierz "Usuń"**: Relacja zostanie usunięta.

#### 3.2 Rozwiązywanie Problemów z Relacjami

Relacje mogą powodować różne problemy, takie jak niejednoznaczne relacje, niepoprawne kardynalności, czy problemy z filtrowaniem.

##### 3.2.1 Problemy z relacjami, np. niejednoznaczne relacje

Niejednoznaczne relacje występują, gdy istnieje więcej niż jedna ścieżka, która łączy dwie tabele, co może powodować konflikty i błędy w raportach.

**Rozwiązanie**:

- **Usuń zbędne relacje**: Upewnij się, że między dwiema tabelami istnieje tylko jedna relacja.
- **Zdefiniuj aktywne i nieaktywne relacje**: Możesz oznaczyć jedną relację jako aktywną, a pozostałe jako nieaktywne.

##### 3.2.2 Ustalanie kardynalności i kierunku filtrowania

Kardynalność określa, jak wartości w jednej tabeli są powiązane z wartościami w innej tabeli. Kierunek filtrowania określa, jak dane są propagowane między tabelami.

**Kardynalność**:

- **Jeden-do-wielu (1:N)**: Jedna wartość w tabeli A odpowiada wielu wartościom w tabeli B.
- **Wiele-do-wielu (N:N)**: Wartości w tabeli A mogą mieć wiele odpowiadających im wartości w tabeli B i odwrotnie.

**Kierunek filtrowania**:

Określa, jak filtry są propagowane między tabelami. Power BI obsługuje dwa główne kierunki filtrowania:

**Filtrowanie jednokierunkowe**

W filtrowaniu jednokierunkowym dane przepływają tylko w jednym kierunku – z tabeli źródłowej do tabeli docelowej.

**Przykład**:

- Tabela **Produkty** → Tabela **Sprzedaż**:
  - Jeśli filtrujesz tabelę "Produkty" (np. wybierasz konkretny produkt), Power BI automatycznie filtruje dane w tabeli "Sprzedaż", ale nie odwrotnie.

**Filtrowanie dwukierunkowe**

W filtrowaniu dwukierunkowym dane przepływają w obu kierunkach – z jednej tabeli do drugiej i z powrotem.

**Przykład**:

- Tabela **Produkty** ↔ Tabela **Sprzedaż**:
  - Jeśli filtrujesz tabelę "Produkty" (np. wybierasz konkretny produkt), Power BI automatycznie filtruje dane w tabeli "Sprzedaż". Jednocześnie, filtrując tabelę "Sprzedaż" (np. wybierając konkretne transakcje), Power BI filtruje dane w tabeli "Produkty".

##### 3.2.3 Używanie aktywnych i nieaktywnych relacji

Aktywne relacje są domyślnie używane w analizach, podczas gdy nieaktywne relacje mogą być używane w razie potrzeby.

**Aktywna relacja**:

- Jest automatycznie używana w analizach i wizualizacjach.

**Nieaktywna relacja**:

- Może być używana za pomocą funkcji DAX (np. funkcja `USERELATIONSHIP`).

Aby ustawić relację jako aktywną lub nieaktywną:

1. **Przejdź do widoku "Model"**.
2. **Kliknij dwukrotnie linię relacji**: Otworzy się okno dialogowe "Edycja relacji".
3. **Zaznacz lub odznacz pole "Aktywna relacja"**.
4. **Zatwierdź zmiany**: Kliknij "OK", aby zapisać zmiany.

### Przykłady

1. **Edytowanie relacji**:
   - Załóżmy, że masz relację między tabelą "Zamówienia" a tabelą "Klienci" na podstawie "ID klienta".
   - Dwukrotnie kliknij linię relacji, aby zmienić kierunek filtrowania na dwukierunkowy.

2. **Rozwiązywanie problemów z niejednoznacznymi relacjami**:
   - Jeśli masz dwie relacje między tabelami "Sprzedaż" i "Produkty", usuń jedną z relacji lub ustaw jedną jako nieaktywną.

3. **Używanie funkcji DAX z nieaktywną relacją**:
   - Możesz użyć funkcji `USERELATIONSHIP` w DAX, aby w obliczeniach wykorzystać nieaktywną relację.

   ```DAX
   SUMX(
     USERELATIONSHIP('Sprzedaż'[ID produktu], 'Produkty'[ID produktu]),
     'Sprzedaż'[Kwota]
   )
   ```

Te kroki pozwolą na efektywne zarządzanie relacjami w Power BI, co przyczyni się do tworzenia spójnych i precyzyjnych analiz danych.

## Tworzenie kolumn obliczeniowych

//TODO

## Optymalizowanie modeli danych

//TODO

## Tworzenie miar

### Co to są miary?

**Miary** to formuły DAX (Data Analysis Expressions) w Power BI, które pozwalają na dynamiczne obliczenia na Twoich danych. Miary są używane do analizowania i agregowania danych w celu uzyskania konkretnych wyników, takich jak sumy, średnie, minimum, maksimum, czy bardziej zaawansowane kalkulacje.

Miary różnią się od kolumn obliczeniowych, ponieważ obliczają wyniki w czasie rzeczywistym, w zależności od kontekstu, w którym są używane. Kontekst ten może być określony przez filtry, segmenty, hierarchie, lub inne elementy wizualizacji w Power BI.

### Do czego są używane miary?

Miary są używane do tworzenia dynamicznych obliczeń, które reagują na interakcje użytkowników z raportem. Oto kilka przykładów zastosowań miar:

1. **Sumy i Agregacje**:
   - Sumowanie wartości sprzedaży.
   - Obliczanie średniej wartości transakcji.
   - Liczenie liczby unikalnych klientów.

2. **Analizy Trendów**:
   - Obliczanie wzrostu sprzedaży rok do roku.
   - Porównywanie wyników sprzedaży między kwartałami.

3. **Metryki Finansowe**:
   - Obliczanie marży brutto.
   - Wyznaczanie zwrotu z inwestycji (ROI).

4. **Zaawansowane Analizy**:
   - Tworzenie wskaźników KPI (Key Performance Indicators).
   - Analizy scenariuszy "what-if".
   - Obliczanie średnich ruchomych.

### Przykłady miar w DAX

Oto kilka przykładowych miar w DAX i ich zastosowania:

1. **Suma wartości sprzedaży**:

   ```DAX
   SumaSprzedaży = SUM('Sprzedaż'[Kwota])
   ```

   Ta miara oblicza sumę wartości sprzedaży z kolumny `Kwota` w tabeli `Sprzedaż`.

2. **Średnia wartości sprzedaży**:

   ```DAX
   ŚredniaSprzedaży = AVERAGE('Sprzedaż'[Kwota])
   ```

   Ta miara oblicza średnią wartość sprzedaży.

3. **Liczba unikalnych klientów**:

   ```DAX
   UnikalniKlienci = DISTINCTCOUNT('Sprzedaż'[ID Klienta])
   ```

   Ta miara liczy unikalnych klientów na podstawie `ID Klienta`.

4. **Wzrost sprzedaży rok do roku**:

   ```DAX
   WzrostSprzedażyRokDoRoku = 
   CALCULATE(
     [SumaSprzedaży], 
     SAMEPERIODLASTYEAR('Kalendarium'[Data])
   )
   ```

   Ta miara oblicza sprzedaż w tym samym okresie poprzedniego roku.

5. **Marża brutto**:

   ```DAX
   MarżaBrutto = 
   DIVIDE(
     SUM('Sprzedaż'[ZyskBrutto]), 
     SUM('Sprzedaż'[Przychody])
   )
   ```

   Ta miara oblicza marżę brutto jako stosunek zysku brutto do przychodów.

### Tworzenie miary w Power BI

Aby stworzyć miarę w Power BI Desktop

1. **Przejdź do widoku "Dane" lub "Model"**.
2. **Wybierz tabelę**, do której chcesz dodać miarę.
3. **Kliknij "Nowa miara"** na wstążce "Modelowanie".
4. **Wpisz formułę DAX** w edytorze formuł.
5. **Nazwij miarę** i zatwierdź formułę, klikając "Enter".

### Przykład praktyczny

Załóżmy, że chcesz obliczyć całkowitą wartość sprzedaży oraz średnią wartość sprzedaży na zamówienie. Możesz utworzyć dwie miary:

1. **Całkowita wartość sprzedaży**:

   ```DAX
   CałkowitaSprzedaż = SUM('Sprzedaż'[Kwota])
   ```

2. **Średnia wartość sprzedaży na zamówienie**:

   ```DAX
   ŚredniaSprzedażNaZamówienie = AVERAGE('Sprzedaż'[Kwota])
   ```

Po utworzeniu tych miar możesz je wykorzystać w wizualizacjach Power BI, takich jak tabele, wykresy, karty KPI, itp. Te miary będą dynamicznie dostosowywać się do filtrów i segmentów, które zastosujesz w swoim raporcie, co umożliwi interaktywne analizowanie danych.

Miary są niezwykle potężnym narzędziem w Power BI, umożliwiającym tworzenie zaawansowanych analiz i raportów. Dzięki nim można łatwo przekształcić surowe dane w wartościowe informacje, które wspierają podejmowanie decyzji.

## Tabele Obliczeniowe w Power BI

### Co to są tabele obliczeniowe?

Tabele obliczeniowe w Power BI to tabele, które są tworzone na podstawie formuł DAX (Data Analysis Expressions) zamiast bezpośredniego importu danych z zewnętrznych źródeł. Umożliwiają one tworzenie nowych struktur danych, które można wykorzystać w modelu danych do zaawansowanych analiz, bez konieczności modyfikacji źródłowych danych.

### Do czego są używane tabele obliczeniowe?

Tabele obliczeniowe są używane do różnych celów, takich jak:

1. **Tworzenie pomocniczych tabel do analizy**:
   - Generowanie tabel z określonymi wartościami, które ułatwiają analizę danych.
   - Agregowanie lub przekształcanie istniejących danych w nowe formy.

2. **Tworzenie kalendarzy i tabel czasu**:
   - Budowanie kalendarzy dat, które są niezbędne do analizowania danych w kontekście czasu.
   - Tworzenie tabel, które zawierają dni, tygodnie, miesiące, kwartały, lata i inne jednostki czasu.

3. **Tworzenie tabel mostkowych (bridge tables)**:
   - Tworzenie tabel, które łączą inne tabele w modelu danych, ułatwiając tworzenie relacji wiele-do-wielu.

4. **Tworzenie słowników i tabel pomocniczych**:
   - Generowanie tabel słownikowych, które mogą być używane do mapowania wartości między różnymi tabelami.

5. **Agregowanie danych**:
   - Tworzenie tabel z agregowanymi danymi na różnych poziomach szczegółowości.

### Przykłady tabel obliczeniowych w DAX

Oto kilka przykładów formuł DAX, które tworzą tabele obliczeniowe:

#### 1. Tabela Kalendarza

Jednym z najczęściej używanych zastosowań tabel obliczeniowych jest tworzenie kalendarza dat.

```DAX
Kalendarz = 
CALENDAR(
    DATE(2020, 1, 1), 
    DATE(2023, 12, 31)
)
```

Ta formuła tworzy tabelę zawierającą daty od 1 stycznia 2020 do 31 grudnia 2023.

#### 2. Tabela z unikalnymi wartościami z innej tabeli

Tworzenie tabeli z unikalnymi wartościami z kolumny w innej tabeli.

```DAX
UnikalneProdukty = 
VALUES('Sprzedaż'[ProduktID])
```

Ta formuła tworzy tabelę zawierającą unikalne wartości z kolumny `ProduktID` w tabeli `Sprzedaż`.

#### 3. Tabela z agregowanymi danymi

Tworzenie tabeli z sumarycznymi wartościami sprzedaży na podstawie miesięcy.

```DAX
SprzedażMiesięczna = 
SUMMARIZE(
    'Sprzedaż', 
    'Sprzedaż'[Rok], 
    'Sprzedaż'[Miesiąc], 
    "CałkowitaSprzedaż", SUM('Sprzedaż'[Kwota])
)
```

Ta formuła tworzy tabelę z sumarycznymi wartościami sprzedaży, zgrupowanymi według roku i miesiąca.

#### Tworzenie tabeli obliczeniowej w Power BI

Aby stworzyć tabelę obliczeniową w Power BI Desktop:

1. **Przejdź do widoku "Model" lub "Dane"**.
2. **Kliknij "Nowa tabela"** na wstążce "Modelowanie".
3. **Wpisz formułę DAX** w edytorze formuł.
4. **Nazwij tabelę** i zatwierdź formułę, klikając "Enter".

